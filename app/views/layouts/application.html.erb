<!DOCTYPE html>
<html>
<head>
  <title>Teresa</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>
<body>
<% if logged_in? %>
<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <%= link_to 'UCB', publications_path, class: 'navbar-brand' %>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><%= link_to "#{current_user.name}", profile_path(current_user.name) %></li>
        <li><%= link_to 'Publicaciones', publications_path %></li>
        <li><a href="#">Notificaciones</a></li>

        <li><%= link_to 'Terminar sesion', sign_out_path, method: :delete %></li>
      </ul>
      <%= form_tag search_path, id: "formulario", class: 'navbar-form navbar-left', method: :get do %>
          <div class="form-group">
            <%= text_field_tag :query, params[:query],  class: 'form-control typeahead', placeholder:"Buscar personas" %>
          </div>
          <%= submit_tag 'Search', class: 'btn btn-primary' %>

      <% end %>

    </div>
  </div>
</nav>
<% end %>

  <%= yield %>


</body>
</html>

<script>
    var people = new Bloodhound({
        datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
        queryTokenizer: Bloodhound.tokenizers.whitespace,

        remote: {
            url: '../autocomplete/%QUERY',
            wildcard: '%QUERY'

        }
    });

    $('.typeahead').typeahead(null, {
        name: 'people',
        display: 'name',
        source: people.ttAdapter()
    }).on('typeahead:selected', function () {
        console.log('selecionado');
//        alert('franz');
        document.getElementById("formulario").submit();
    });
</script>
